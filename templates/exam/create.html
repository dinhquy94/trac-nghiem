{% extends "base.html" %}

{% block title %}Táº¡o Ä‘á» thi{% endblock %}

{% block content %}
<div class="card" style="max-width: 600px; margin: 0 auto;">
    <h2 class="card-header">ğŸ“ Táº¡o Ä‘á» thi má»›i</h2>
    
    <form method="POST">
        <div class="form-group">
            <label class="form-label">TiÃªu Ä‘á» Ä‘á» thi <span style="color: red;">*</span></label>
            <input type="text" name="title" class="form-control" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">MÃ´ táº£</label>
            <textarea name="description" class="form-control" rows="3"></textarea>
        </div>
        
        <div class="form-group">
            <label class="form-label">Loáº¡i Ä‘á» thi <span style="color: red;">*</span></label>
            <select name="exam_type" id="examType" class="form-control" required>
                <option value="test">Kiá»ƒm tra (cÃ³ giá»›i háº¡n thá»i gian)</option>
                <option value="practice">Ã”n táº­p (khÃ´ng giá»›i háº¡n, cÃ³ giáº£i thÃ­ch)</option>
            </select>
        </div>
        
        <div class="grid grid-2">
            <div class="form-group" id="durationGroup">
                <label class="form-label">Thá»i gian (phÃºt) <span style="color: red;">*</span></label>
                <input type="number" name="duration" class="form-control" value="60" min="1" id="durationInput" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Äiá»ƒm Ä‘áº¡t (%) <span style="color: red;">*</span></label>
                <input type="number" name="passing_score" class="form-control" value="50" min="0" max="100" required>
            </div>
        </div>
        
        <div class="form-group">
            <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                <input type="checkbox" name="is_public">
                <span>CÃ´ng khai Ä‘á» thi (cho phÃ©p há»c sinh lÃ m bÃ i)</span>
            </label>
        </div>
        
        <div class="d-flex gap-2">
            <button type="submit" class="btn btn-primary" id="submitBtn">Táº¡o Ä‘á» thi</button>
            <a href="{{ url_for('exam.list_exams') }}" class="btn btn-secondary">Há»§y</a>
        </div>
    </form>
</div>

<script>
document.getElementById('examType').addEventListener('change', function() {
    const durationGroup = document.getElementById('durationGroup');
    const durationInput = document.getElementById('durationInput');
    const passingScoreInput = document.querySelector('input[name="passing_score"]');
    
    if (this.value === 'practice') {
        // Ã”n táº­p: áº©n thá»i gian, khÃ´ng yÃªu cáº§u Ä‘iá»ƒm Ä‘áº¡t
        durationGroup.style.display = 'none';
        durationInput.required = false;
        durationInput.value = 0;
        passingScoreInput.required = false;
        passingScoreInput.value = 0;
    } else {
        // Kiá»ƒm tra: hiá»ƒn thá»‹ thá»i gian, yÃªu cáº§u Ä‘iá»ƒm Ä‘áº¡t
        durationGroup.style.display = 'block';
        durationInput.required = true;
        durationInput.value = 60;
        passingScoreInput.required = true;
        passingScoreInput.value = 50;
    }
});

// Validate form trÆ°á»›c khi submit
document.querySelector('form').addEventListener('submit', function(e) {
    const title = document.querySelector('input[name="title"]').value.trim();
    const examType = document.getElementById('examType').value;
    const duration = parseInt(document.getElementById('durationInput').value);
    
    if (!title) {
        e.preventDefault();
        alert('Vui lÃ²ng nháº­p tiÃªu Ä‘á» Ä‘á» thi');
        return false;
    }
    
    if (examType === 'test' && duration < 1) {
        e.preventDefault();
        alert('Vui lÃ²ng nháº­p thá»i gian lÃ m bÃ i há»£p lá»‡ (tá»‘i thiá»ƒu 1 phÃºt)');
        return false;
    }
    
    return true;
});
</script>
{% endblock %}
